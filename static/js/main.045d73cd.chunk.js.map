{"version":3,"sources":["Constellation/Constellation.js","Constellation/useAnimationFrame.js","App.js","index.js"],"names":["Constellation","props","width","height","className","starsColor","starsWidth","starsCount","starsVelocity","starsVelocityChaos","lineColor","lineWidth","lineMaxDistance","lineCursorRadius","initStars","useState","stars","setStars","x","y","mousePosition","setMousePosition","canvasRef","React","useRef","useEffect","console","log","canvas","current","context","getContext","onMouseMove","e","pageX","getBoundingClientRect","left","pageY","top","createStar","Math","random","velX","velY","i","starList","length","star","push","createAllStars","fillStyle","strokeStyle","document","addEventListener","removeEventListener","drawStars","useCallback","forEach","beginPath","arc","PI","fill","drawLines","j","iStar","jStar","abs","moveTo","lineTo","stroke","closePath","animateStars","callback","depency","requestRef","previousTimeRef","animate","time","undefined","deltaTime","requestAnimationFrame","cancelAnimationFrame","useAnimationFrame","clearRect","ref","defaultProps","window","innerWidth","innerHeight","App","size","setSize","onResize","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.045d73cd.chunk.js","sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\r\nimport useAnimationFrame from \"./useAnimationFrame\";\r\n\r\n\r\nfunction Constellation(props) {\r\n  // console.log(\"Constellation\")\r\n  const {\r\n    width, height, className,\r\n    starsColor, starsWidth, starsCount, starsVelocity, starsVelocityChaos,\r\n    lineColor, lineWidth, lineMaxDistance, lineCursorRadius,\r\n    initStars,\r\n  } = props;\r\n\r\n  const [stars, setStars] = useState([])\r\n\r\n  const [mousePosition, setMousePosition] = useState({\r\n    x: width * 0.5,\r\n    y: height * 0.5\r\n  })\r\n\r\n  const canvasRef = React.useRef(null)\r\n\r\n  useEffect(() => {\r\n    console.log(\"Constellation useEffect\")\r\n    const canvas = canvasRef.current;\r\n    const context = canvas.getContext('2d')\r\n\r\n    function createAllStars() {\r\n      function createStar(x, y) {\r\n        return {\r\n          x: x || (Math.random() * width),\r\n          y: y || (Math.random() * height),\r\n          velX: starsVelocity * (Math.random() - 0.5),\r\n          velY: starsVelocity * (Math.random() - 0.5),\r\n        }\r\n      }\r\n      const starList = [];\r\n      let i;\r\n      for (i = 0; i < initStars.length && i < starsCount; i++) {\r\n        const star = initStars[i];\r\n        starList.push(createStar(\r\n          star.x * width,\r\n          star.y * height + height / 2\r\n        ));\r\n      }\r\n\r\n      for (; i < starsCount; i++) {\r\n        starList.push(createStar());\r\n      }\r\n      // console.log(\"starList\", starList)\r\n\r\n      setStars(starList);\r\n    }\r\n    function setCanvas() {\r\n      context.fillStyle = starsColor;\r\n      context.strokeStyle = lineColor;\r\n      context.lineWidth = lineWidth;\r\n    }\r\n\r\n    createAllStars();\r\n    setCanvas();\r\n\r\n    function onMouseMove(e) {\r\n      setMousePosition({\r\n        x: e.pageX - canvas.getBoundingClientRect().left,\r\n        y: e.pageY - canvas.getBoundingClientRect().top\r\n      })\r\n    }\r\n\r\n    document.addEventListener('mousemove', onMouseMove);\r\n\r\n    return function () {\r\n      document.removeEventListener('mousemove', onMouseMove)\r\n    }\r\n    // .on('resize', this.handlers.window.resize.bind(this));\r\n\r\n  }, [height, initStars, lineColor, lineWidth, starsColor, starsCount, starsVelocity, width])\r\n\r\n\r\n  const drawStars = useCallback((context) => {\r\n    // console.log(\"drawStars\", stars.length)\r\n    stars.forEach(star => {\r\n\r\n      // console.log(\"star\", star)\r\n      context.beginPath();\r\n      // context.arc(100, 75, 50, 0, 2 * Math.PI);\r\n      context.arc(star.x, star.y, starsWidth, 0, Math.PI * 2, false);\r\n      context.fill();\r\n    });\r\n  }, [stars, starsWidth])\r\n\r\n  const drawLines = useCallback(context => {\r\n    // console.log(\"drawLines\", stars.length);\r\n    if (!stars.length) return;\r\n    for (let i = 0; i < starsCount; i++) {\r\n      for (let j = 0; j < starsCount; j++) {\r\n        const iStar = stars[i];\r\n        const jStar = stars[j];\r\n\r\n        if (\r\n          Math.abs(iStar.x - jStar.x) < lineMaxDistance &&\r\n          Math.abs(iStar.y - jStar.y) < lineMaxDistance\r\n        ) {\r\n          if (\r\n            Math.abs(iStar.x - mousePosition.x) < lineCursorRadius &&\r\n            Math.abs(iStar.y - mousePosition.y) < lineCursorRadius\r\n            // to improve jStar\r\n          ) {\r\n            // console.log(iStar.x, iStar.y, mousePosition)\r\n            context.beginPath();\r\n            context.moveTo(iStar.x, iStar.y);\r\n            context.lineTo(jStar.x, jStar.y);\r\n            context.stroke();\r\n            context.closePath();\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }, [stars, mousePosition, starsCount, lineMaxDistance, lineCursorRadius])\r\n\r\n  const animateStars = useCallback(() => {\r\n    stars.forEach(star => {\r\n      if (star.y < 0 || star.y > height || Math.random() < starsVelocityChaos) {\r\n        star.velY = - star.velY;\r\n      }\r\n      if (star.x < 0 || star.x > width || Math.random() < starsVelocityChaos) {\r\n        star.velX = - star.velX;\r\n      }\r\n\r\n      star.x += star.velX;\r\n      star.y += star.velY;\r\n    });\r\n  }, [stars, height, starsVelocityChaos, width])\r\n\r\n\r\n  useAnimationFrame(() => {\r\n    const canvas = canvasRef.current;\r\n    if(!canvas) return;\r\n    const context = canvas.getContext('2d')\r\n    context.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n    drawStars(context);\r\n    drawLines(context);\r\n    animateStars();\r\n  }, [stars, mousePosition])\r\n\r\n  return (\r\n    <>\r\n      <canvas\r\n        className={className}\r\n        ref={canvasRef}\r\n        width={width}\r\n        height={height}\r\n      />\r\n    </>\r\n  )\r\n}\r\n\r\nConstellation.defaultProps = {\r\n  width: window.innerWidth,   // width of canvas\r\n  height: window.innerHeight, // height of canvas\r\n  starsColor: 'black',\r\n  starsWidth: 1,\r\n  starsCount: 100,      // 畫面上有多少stars\r\n  starsVelocity: 0.1,    // stars的移動速度\r\n  starsVelocityChaos: 8e-4,    // stars的移動方向，多大的機率會被改變\r\n\r\n  lineColor: 'black',\r\n  lineWidth: 0.2,\r\n  lineMaxDistance: 120,    // 兩個stars間隔多遠以內，就要連線\r\n  lineCursorRadius: 150,      // 以滑鼠位置為圓心，多大的範圍內要highlight lines\r\n\r\n  initStars: [],    // 指定一開始stars的位置\r\n}\r\n\r\n\r\n\r\n\r\n\r\nexport default Constellation;\r\n","import { useRef, useEffect } from \"react\";\r\n\r\n\r\nexport default function useAnimationFrame(callback, depency) {\r\n  // Use useRef for mutable variables that we want to persist\r\n  // without triggering a re-render on their change\r\n  const requestRef = useRef();\r\n  const previousTimeRef = useRef();\r\n\r\n  const animate = time => {\r\n    if (previousTimeRef.current !== undefined) {\r\n      const deltaTime = time - previousTimeRef.current;\r\n      callback(deltaTime)\r\n    }\r\n    previousTimeRef.current = time;\r\n    requestRef.current = requestAnimationFrame(animate);\r\n  }\r\n\r\n  useEffect(() => {\r\n    requestRef.current = requestAnimationFrame(animate);\r\n    return () => cancelAnimationFrame(requestRef.current);\r\n  }, depency); // Make sure the effect runs only once\r\n}\r\n","import Constellation from \"./Constellation/Constellation\";\nimport React, { useEffect, useState } from 'react';\n\nfunction App() {\n  const [size, setSize] = useState({\n    width: window.innerWidth, height: window.innerHeight\n  });\n\n  useEffect(() => {\n    function onResize() {\n      setSize({\n        width: window.innerWidth, height: window.innerHeight\n      });\n    }\n    window.addEventListener('resize', onResize);\n\n    return () => window.removeEventListener('resize', onResize);\n  }, [])\n\n\n  return (\n    <Constellation\n      // key={count}\n      width={size.width}\n      height={size.height}\n      className=\"constellation\"\n\n      starsColor=\"rgba(255, 255, 255, 1)\"\n      starsWidth={1.1*size.width/1200}\n      starsCount={500*size.width/1200}\n      starsVelocity={0.45*size.width/1200}\n      starsVelocityChaos={3e-3}\n\n      lineColor=\"rgba(255, 255, 255, .8)\"\n      lineWidth={0.3*size.width/1200}\n      lineMaxDistance={80*size.width/1200}\n      lineCursorRadius={100*size.width/1200}\n    />\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}